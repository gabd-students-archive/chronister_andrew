---
title: "HW 09: Strings"
author: "Andrew Chronister"
date: "`r format(Sys.time(), '%d %B %Y')`"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---
***
###Install and load the libraries
```{r}
install.packages("ggthemes")
install.packages("RColorBrewer")
install.packages("viridis")
library(tidyverse)
library(htmlwidgets)

```
***
###Define the file.path
```{r}
file_path <- "~/Documents/BI685Files/GitHubDocs/chronister_andrew/data"
```


***
###Part 1:DNA Strings
***
####Read in the data
```{r}
(gliadin_raw <- read_lines(file.path(file_path, "beta_gliadin.txt"), skip = 1))
```
***
###"Tidy" and "Wrangle" the data
#Getting rid of the spaces, digits and tabs.
```{r}
gliadin_interm <- gliadin_raw%>%
  str_replace_all(" ", "")%>%
  str_replace_all("\\d", "")%>%
  str_replace_all("\\t", "")
gliadin_interm
```
#Collapse the strings into just one string.
```{r}
gliadin_seq <- gliadin_interm%>%
  str_c(collapse = "")
gliadin_seq
```
#Convert case to upper.
```{r}
gliadin_seq <- gliadin_seq%>%
  str_to_upper()
gliadin_seq
str_length(gliadin_seq)
```
#The DNA sequence is 3310 characters long. I guess I got it right.  

***
###Sequence analysis: find the promoter region
#Use string count to find non ACGT letters.
```{r}
str_count(gliadin_seq, "[^ACGT]")
```
#I came up with 0 letters that are not ACGT.

#Count possible Start codons. Count possible Stop codons.
```{r}
str_count(gliadin_seq, "ATG")
str_count(gliadin_seq, "TGA|TTA")
```
#Assign CAAT and TATA box variables
```{r}
caat_box <- c("CCAAT")
tata_box <- c("CTATAA")
str_count(gliadin_seq, caat_box)
str_count(gliadin_seq, tata_box)
```
#Create CAAT sequence searrch string.
```{r}
caat_seq <- "CCAAT.{100,150}ATG"
str_count(gliadin_seq, caat_seq)
```
#The CAAT sequence occurs twice in those conditions. I got hung up on this for a few minutes because a space worked its way in between the "(" and the "ATC".  I kept coming up with 0 in the results.  
#Now for the TATA box extraction
```{r}
caat_seqs_all <- str_extract_all(gliadin_seq, caat_seq, simplify = TRUE)
caat_seqs_all
str_count(caat_seqs_all)

```
#Use str_which to find which seq has tatabox
```{r}
tata_seq <- "CTATAA.{50,100}ATG"
caat_tata <- str_which(caat_seqs_all, tata_seq)
promotor <- str_subset(caat_seqs_all, tata_seq)
promotor
str_length(promotor)
```










